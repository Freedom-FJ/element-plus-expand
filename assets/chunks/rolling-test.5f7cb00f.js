import{d as R,h as g,g as X,z as D,j as w,D as H,H as N,o as z,c as F,k as T,r as S,l as W,e as Y,n as E,U}from"./framework.2f197f38.js";const j={name:"FpiElRolling"},L=R({...j,props:{direction:{type:String,default:"x"},modelValue:{type:Boolean,default:void 0},time:{type:Number,default:10},dragControl:{type:Boolean,default:!1},action:{type:String,default:"hover"}},emits:["update:modelValue","domChange","change"],setup(f,{expose:_,emit:i}){const t=f,r=g(),h=g(),p=g(!0);let s=!1;const m=`rollingsAnnualTasks${Math.floor(Math.random()*1e4)}`;let c=0,v=!1,d=null,x=!1,k=0;const o=X({get(){return t.modelValue===void 0?p.value:t.modelValue},set(e){t.modelValue===void 0?p.value=e:i("update:modelValue",e)}});D(()=>o.value,e=>{!v&&o.value&&u()}),D(()=>t.time,()=>{o.value&&u()}),w(()=>{u(),d=new MutationObserver(e=>{const l=r.value,n=(t.direction==="x"?l.offsetWidth:l.offsetHeight)/2;n!==c&&(i("domChange",n,e),u())}),H(()=>{r.value&&d.observe(r.value,{attributes:!0,childList:!0,characterData:!0,subtree:!0})})}),N(()=>{y(),d&&d.disconnect()});const u=()=>{const e=r.value,l=h.value;if(!e)return;c=(t.direction==="x"?e.offsetWidth:e.offsetHeight)/2;const n=t.direction==="x"?l.offsetWidth:l.offsetHeight,a=y();if(B(n>c),!!o.value){if(s){o.value=!1;return}e.style.animationPlayState="",console.log(c,"distance"),a.insertRule(`@keyframes ${m} {0%{ transform: translateX(0%);}100%{transform: translate${t.direction==="x"?"X":"Y"}(-${c}px);}}`,0),v=!0}},y=()=>{const e=document.styleSheets[0],n=[].slice.call(e.cssRules).findIndex(a=>a.name===m);return n!==-1&&e.deleteRule(n),v=!1,e},$=()=>{s||t.action==="hover"&&(o.value=!1,i("change",!1))},b=()=>{s||t.action==="hover"&&(o.value=!0,i("change",!0))},M=()=>{t.action==="click"&&(i("change",!o.value),o.value=!o.value)},C=()=>{s||t.action==="dblclick"&&(i("change",!o.value),o.value=!o.value)},V=()=>{},A=e=>{!s&&t.dragControl&&(x=!0,k=t.direction==="x"?e.clientX:e.clientY)},P=e=>{if(!x)return;const n=(t.direction==="x"?e.clientX:e.clientY)-k;console.log(n,"ee");const a=r.value;a.style.transform=`translateX(${n}px)`,a.style.animationPlayState="",n>0?(a.style.animationDirection="reverse",a.style.animationDuration=`${t.time/2}s`):(a.style.animationDirection="normal",a.style.animationDuration=`${t.time/2}s`)},B=e=>{s=e};return _({clearAnimation:y,controlAnimation:u,changeForcedStop:B}),(e,l)=>(z(),F("div",{ref_key:"rollingBoxBody",ref:h,class:"fpi-el-rolling-box",onMouseenter:$,onMouseleave:b,onMouseup:V,onMousedown:A,onDblclick:C,onClick:M,onMousemove:P},[T("div",{ref_key:"rollingBody",ref:r,class:E(["fpi-el-rolling",{"fpi-el-rolling-flex":f.direction==="x"}]),style:U({animation:`${m} ${f.time}s linear infinite`,animationPlayState:o.value?"running":"paused"})},[S(e.$slots,"default"),W(s)?Y("",!0):S(e.$slots,"default",{key:0})],6)],544))}});export{L as default};
