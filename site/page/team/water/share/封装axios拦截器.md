
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f568e1c6882e469e872413fb70c2197a~tplv-k3u1fbpfcp-zoom-crop-mark:1512:1512:1512:851.awebp?)
# å‰è¨€
å¯¹äºæ¥å£æ‹¦æˆªçš„ä½¿ç”¨åœºæ™¯æˆ‘ä»¬ä¸€èˆ¬æ˜¯åœ¨ä¸€äº›ç»„ä»¶åˆ‡æ¢çš„æ—¶å€™ï¼Œè™½ç„¶ç»„ä»¶è¢«é”€æ¯ï¼Œä½†æ˜¯å¾€å¾€è¿™ä¸ªæ—¶å€™å†…éƒ¨æ²¡æœ‰å®Œæˆçš„æ¥å£è¯·æ±‚ä»¥åŠå¼‚æ­¥ä»»åŠ¡å·²ç»è¢«æ¨å…¥äº†å¼‚æ­¥é˜Ÿåˆ—ï¼Œå…¶å›è°ƒä¾æ—§ä¼šè¢«ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œæ‰€ä»¥å°±ä¼šå¯¼è‡´å½“ä½ è·¯ç”±æˆ–è€…ç»„ä»¶åˆ‡æ¢çš„æ—¶å€™ä¸€äº›æ¥å£ä»»ç„¶è¢«æ‰§è¡Œã€‚ğŸ¦

æ¯”å¦‚æˆ‘ä»¬åœ¨å†™åœ°å›¾å¤§å±çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„è·¯ç”±ä»¥åŠç»„ä»¶åˆ‡æ¢å¹¶ä¸ä¼šè®©åœ°å›¾ç»„ä»¶åˆ‡æ¢ï¼Œä¹Ÿå°±æ˜¯åœ°å›¾ç»„ä»¶æ˜¯ä¸€ç›´å­˜åœ¨çš„ã€‚â›½ï¸å¦‚æœæˆ‘ä»¬åˆ‡æ¢åˆ°ä¸€ä¸ªé¡µé¢è¯·æ±‚æ¥å£ä¼šæ¸²æŸ“ä¸€äº›ç‚¹ä½ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªæ—¶å€™æ¥å£æ¯”è¾ƒæ…¢ï¼Œæˆ‘ä»¬åˆå¾ˆå¿«çš„åˆ‡æ¢åˆ°äº†å…¶ä»–é¡µé¢ï¼Œè¿™ä¸ªæ—¶å€™vueç»„ä»¶è™½ç„¶è¢«é”€æ¯ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨beforeDestroyçš„æ—¶å€™æ¸…é™¤äº†åœ°å›¾ç‚¹ä½ï¼Œä½†æ˜¯é‡Œé¢çš„å¼‚æ­¥ä»»åŠ¡å·²ç»è¢«æ¨å…¥äº†æ‰§è¡Œé˜Ÿåˆ—ï¼Œå¹¶ä¸ä¼šè¢«é”€æ¯ï¼Œé‚£ä¸Šä¸€ä¸ªé¡µé¢çš„åœ°å›¾ç‚¹ä½å°±å¾ˆå®¹æ˜“æ— æ³•è¢«æ¸…é™¤è€Œå¸¦åˆ°äº†æˆ‘ä»¬å½“å‰çš„é¡µé¢æ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆæ£˜æ‰‹çš„é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å¼•å…¥æˆ‘ä»¬çš„axiosçš„æ¥å£æ‹¦æˆªåŠŸèƒ½äº†ğŸ›ã€‚
# æŠ€æœ¯æ ˆ
**axios**ï¼Œ**vue2**ï¼Œ**vue3**ï¼Œ**TS**ï¼Œ**pinia**
# 1.å®ç°è·¯ç”±åˆ‡æ¢ç»Ÿä¸€æ¥å£æ‹¦æˆª
> æŠ€æœ¯æ ˆï¼švue2 JS

ğŸ’°æˆ‘ä»¬å…ˆæ¥å®ç°ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ¥å£æ‹¦æˆªå…¨å±€æ§åˆ¶æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åœ¨æˆ‘ä»¬è·¯ç”±åˆ‡æ¢çš„æ—¶å€™å®ç°å…¨éƒ¨æ¥å£çš„æ‹¦æˆªï¼Œå› ä¸ºæˆ‘ä»¬ä¸€èˆ¬çš„åº”ç”¨åœºæ™¯åªæ˜¯ä¼šåœ¨è·¯ç”±åˆ‡æ¢çš„æ—¶å€™éœ€è¦ç”¨åˆ°æ¥å£æ‹¦æˆªåŠŸèƒ½ã€‚
## axiosè¯·æ±‚æ‹¦æˆªæ–¹æ³•
```javascript
import axios from 'axios'
let axiosCancel = ''
/**
 * @description åŸºäºaxiosçš„äºŒæ¬¡å°è£…
 */
const Instance = axios.create({
    timeout: 60 * 1000   
})
/**
 * è¯·æ±‚æ‹¦æˆª
 */
Instance.interceptors.request.use(
	config=> {        
		const CancelToken = axios.CancelToken
        const source = CancelToken.source()
        config.cancelToken = source.token // å°†tokenæ³¨å…¥åˆ°è¯·æ±‚ä¸­
        axiosCancel = source        
        return config
	}
)
```
æˆ‘ä»¬åœ¨```axios```çš„æ¥å£è¯·æ±‚æ‹¦æˆªé‡Œé¢å°†å–æ¶ˆæ¥å£tokenæ³¨å…¥åˆ°è¯·æ±‚ä¸­å»å¹¶èµ‹å€¼ç»™äº†æˆ‘ä»¬å®šä¹‰çš„å˜é‡```axiosCancel```ï¼Œè¿™æ ·æˆ‘ä»¬åªéœ€è¦è°ƒç”¨```axiosCancel```çš„```cancel```æ–¹æ³•å°±å¯ä»¥å®ç°æ¥å£çš„æ‹¦æˆª
```javascript
axiosCancel.cancel('å–æ¶ˆäº†æ¥å£â€˜)
```
ğŸ‘€è¿™è¾¹æ³¨æ„åˆ°æˆ‘ä»¬åœ¨ä½¿ç”¨```cancel```çš„æ—¶å€™è¿˜ä¼ å…¥äº†å­—ç¬¦ä¸²ï¼Œæ­¤å­—ç¬¦ä¸²ä¹Ÿä¼šè¢«æˆ‘ä»¬```axios```çš„å“åº”æ‹¦æˆªæ‰€æ‹¦æˆªï¼Œå¹¶ä¼šè·³å…¥```error```ï¼Œä¹Ÿå°±æ˜¯è¢«```try...carch```æ•è·,è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åˆ¤æ–­```message```çš„åç§°æ¥çŸ¥é“æ­¤æ¥å£å¼‚å¸¸çš„åŸå› æ˜¯è¢«æ¥å£æ‹¦æˆªäº†,ä¹Ÿå¯ä»¥é€šè¿‡axiosæä¾›çš„isCancelæ–¹æ³•åˆ¤æ–­æ˜¯å¦æ˜¯è¯·æ±‚æ¥å£æ‹¦æˆªï¼Œé‚£æˆ‘ä»¬ä¸€èˆ¬ä¼šå°è£…æ­¤æƒ…å†µçš„æ¥å£ä¸ä¼šåœ¨ç•Œé¢å‡ºç°é”™è¯¯æç¤º ğŸ¥º

```javascript
/**
 * æ¥å£å“åº”æ‹¦æˆª
 */
Instance.interceptors.response.use(
    response => {
        	....çœç•¥æ­¤å¤„ä»£ç 
    },
    error => {
        // if (error.message !== 'å–æ¶ˆäº†è¯·æ±‚') {
        if(!axios.isCancel(error))
            Message.error({ message: 'æœåŠ¡å¼‚å¸¸ï¼Œè¯·ç¨åå†è¯•' })
        }
        return Promise.reject(error)
    }
)
```
## å®ç°è·¯ç”±åˆ‡æ¢æ‹¦æˆªæ‰€æœ‰æ¥å£
ç°åœ¨æˆ‘ä»¬ğŸ˜¯åªéœ€è¦å°†è¿™ä¸ªè£…æœ‰æ‹¦æˆªtokençš„å˜é‡æ³¨å…¥åˆ°æˆ‘ä»¬ä»»ä½•æƒ³æ‹¦æˆªä»–çš„åœ°æ–¹å°±å¯ä»¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒèµ‹å€¼ç»™windowå¯¹è±¡ï¼Œä¹Ÿå¯ä»¥èµ‹å€¼ç»™vuexå˜é‡éƒ½å¯ä»¥ã€‚ä»¥ä¸‹ä»¥windowå¯¹è±¡ä¸ºä¾‹ğŸŒ°
```javascript
Instance.interceptors.request.use(
	config=> {
		!window.axiosCancel && (window.axiosCancel = [])
        const CancelToken = axios.CancelToken
        const source = CancelToken.source()
        config.cancelToken = source.token // å°†tokenæ³¨å…¥åˆ°è¯·æ±‚ä¸­
        window.axiosCancel.push(source)
        return config
	}
)
```
å†é…ç½®ä¸€ä¸‹æˆ‘ä»¬çš„è·¯ç”±å®ˆå«ï¼Œåˆ¤æ–­å¦‚æœæ˜¯åˆå§‹åŒ–ä¹Ÿå°±æ˜¯'/'åœ°å€ï¼Œé‚£ä¹ˆå°±è®¾ç½®```window.axiosCancel = []```,ğŸ€„ï¸åœ¨è·¯ç”±åˆ‡æ¢çš„æ—¶å€™å°†æ‰€æœ‰çš„æ¥å£éƒ½éå†æ‹¦æˆªå³å¯ï¼š
```javascript
const router = new VueRouter({
	routes: newRoutes // è¿™æ˜¯æˆ‘ä»¬çš„è·¯ç”±æ•°æ® å†æ­¤å°±ä¸å†™äº†
})
/**
 * è·¯ç”±å®ˆå«
 */
router.beforeEach((to, from, next) => {
    if (from.path === '/') {
        window.axiosCancel = []
        return next()
    } else {
        const cancelArr = window.axiosCancel
        cancelArr.forEach(ele => {
            ele.cancel('å–æ¶ˆäº†è¯·æ±‚') // åœ¨å¤±è´¥å‡½æ•°ä¸­è¿”å›è¿™é‡Œè‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯
        })
        window.axiosCancel = []
        return next()
    }
})
```
å½“ç„¶ä¸ºäº†é¿å…è·¯ç”±åˆ‡æ¢å°†ä¸€äº›æ¯”è¾ƒé‡è¦çš„åŸºç¡€ä¿¡æ¯æ¥å£ä¹Ÿç»™æ‹¦æˆªäº†æˆ‘ä»¬å¯ä»¥åŠ å…¥ç™½åå•åŠŸèƒ½ï¼Œå¦‚æœæˆ‘ä»¬çš„severæ˜¯æ¯”è¾ƒè§„èŒƒçš„ç±»ä¼¼äº```wgms-base-server```æœ‰ä¸€å®šçš„å‘½åè§„å¾‹æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨æ­£åˆ™æå–æ¯”è¾ƒï¼Œä¸ç„¶çš„ç”»åªèƒ½éå†ç™½åå•ä¾æ¬¡æ¯”è¾ƒäº†,å‰è€…ç›¸è¾ƒäºåè€…è®¡ç®—å¤æ‚åº¦ä¼šä½ä¸€äº›

```javascript
const whiteInterceptServer = ['simple-user-center-server', 'bsp-permission-server']
// if (!whiteInterceptServer.includes(config.url.match(/[\w-]*(?=-server)/)?.[0] + '-server')) {
if (!whiteInterceptServer.some(url => config.url.includes(url))) {
    !window.axiosCancel && (window.axiosCancel = [])
    const CancelToken = axios.CancelToken
    const source = CancelToken.source()
    config.cancelToken = source.token // å°†tokenæ³¨å…¥åˆ°è¯·æ±‚ä¸­
    window.axiosCancel.push(source)
}
```

åŸºæœ¬ä¸Šä»¥ä¸Šæ–¹æ³•å¯ä»¥è§£å†³ä¸€äº›ç®€å•çš„æ¥å£æ‹¦æˆªåº”ç”¨æƒ…å†µï¼Œåƒæˆ‘ä»¬å…¬å¸çš„è€é¡¹ç›®åŸºæœ¬ä¸Šä¸Šè¿™ä¸ªå°±å¤Ÿäº†ï¼Œæ­¤æ–¹å¼å¯¹äºä¸€äº›è€é¡¹ç›®çš„å‡çº§æ˜¯å†å¥½ä¸è¿‡çš„äº†ï¼ŒåŸºæœ¬ä¸ä¼šå½±å“åˆ°ä¹‹å‰ä»£ç çš„é€»è¾‘ï¼Œä¸”å¼€å‘è€…å¯¹æ¥å£æ‹¦æˆªæ— éœ€æ„ŸçŸ¥ï¼Œä¸ç”¨ä»‹å…¥å†…éƒ¨é€»è¾‘ï¼Œä½†æ˜¯æ–°é¡¹ç›®æˆ‘ä»¬å¯ä»¥ä¸æ­¢äºæ­¤ã€‚ğŸ¦•
æ­¤å°è£…è¿˜æ˜¯æœ‰å¾ˆå¤šå¼Šç«¯ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨æ‰‹åŠ¨åˆ‡æ¢è·¯ç”±çš„æ—¶å€™ï¼Œä¸å¤Ÿçµæ´»ï¼Œè¿˜æ˜¯å®¹æ˜“æ‹¦æˆªä¸€äº›ä¸å¿…è¦çš„æ¥å£ï¼Œä»¥åŠæ‹¦æˆªçš„æ—¶æœºæ¯”è¾ƒå•ä¸€ï¼Œåªèƒ½åœ¨è·¯ç”±åˆ‡æ¢çš„æ—¶å€™ï¼Œæ‰€ä»¥æˆ‘ä»¬é’ˆå¯¹ä»¥ä¸‹ä¸¤ä¸ªç‚¹è¿›è¡Œä¼˜åŒ–ï¼šğŸ‘¬
>- è‡ªå®šä¹‰æ‹¦æˆªæ¥å£
>- è‡ªå®šä¹‰æ‹¦æˆªæ—¶æœº
# 2.æœ€ç»ˆï¼šå®ç°é«˜åº¦è‡ªå®šä¹‰æ¥å£æ‹¦æˆªåŠŸèƒ½
> æŠ€æœ¯æ ˆï¼švue3 TS pinia
## å‡†å¤‡æ‹¦æˆªæ¥å£å­˜å‚¨ä»¥åŠæ–¹æ³•
é¦–å…ˆæˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸ªå…¨å±€çš„å˜é‡æ¥ç®¡ç†æˆ‘ä»¬éœ€è¦è¢«æ‹¦æˆªçš„æ¥å£ï¼Œå¹¶å°è£…ä¸€äº›æ–¹æ³•ç”¨äºæ§åˆ¶æ¥å£çš„æ‹¦æˆªä»¥åŠé˜Ÿåˆ—æ¸…ç©ºï¼Œæ‰€ä»¥å°±éœ€è¦ç”¨åˆ°```store```çš„æ€æƒ³æˆ‘ä»¬å°±å¯ä»¥å¼•å…¥```piniaï¼ˆvue2çš„è¯å¯ä»¥ä½¿ç”¨vuexï¼‰```
å®‰è£…ï¼šğŸ¤”
```
yarn add pinia
```
main.ts
```javascript
import { createPinia } from 'pinia'
// ã€‚ã€‚ã€‚æ­¤å¤„çœç•¥ä»£ç 
const app = createApp(App)
app.use(createPinia())
app.mount('#app')
```
åˆ›å»ºæˆ‘ä»¬çš„axiosæ–‡ä»¶ğŸ“ï¼šsrc/store/axios.ts
```javascript

/*
 * @Author: mjh
 * @Date: 2022-09-06 09:21:32
 * @LastEditors: mjh
 * @LastEditTime: 2022-10-23 23:46:45
 * @Description:
 */
import { defineStore } from 'pinia'
import type { Canceler } from 'axios'

export const useAxiosStore = defineStore({
    // id: å¿…é¡»çš„ï¼Œåœ¨æ‰€æœ‰ Store ä¸­å”¯ä¸€
    id: 'axios',
    state: () => ({
            interceptArray: [] as Canceler[] // å­˜æ”¾æ‹¦æˆªæ¥å£
    }),
    // getters
    getters: {
        countInterceptCount: state => state.interceptArray.length,
        interceptArrayData: state => state.interceptArray
    },
    actions: {
    	// æ·»åŠ æ¥å£è¿›å…¥æ‹¦æˆªé˜Ÿåˆ—
        async addIntercept(cancel: Canceler) {
            // å¯ä»¥åšå¼‚æ­¥            
            this.interceptArray.push(cancel)
        },
        // æ‹¦æˆªé˜Ÿåˆ—å†…çš„æ¥å£å¹¶åˆ é™¤
        async clearIntercept(num?: number) {
            if (num) {
                const length = this.interceptArray.length
                this.interceptArray.slice(-num).forEach((cancel) => {
                    cancel('å–æ¶ˆäº†è¯·æ±‚') // åœ¨å¤±è´¥å‡½æ•°ä¸­è¿”å›è¿™é‡Œè‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯
                })
                this.interceptArray = this.interceptArray.slice(0, length - num)
                return
            }
            this.interceptArray.forEach((cancel) => {
                cancel('å–æ¶ˆäº†è¯·æ±‚') // åœ¨å¤±è´¥å‡½æ•°ä¸­è¿”å›è¿™é‡Œè‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯
            })
            this.interceptArray = []
        }
    }
})
```
è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†æ‹¦æˆªæ¥å£çš„å­˜æ”¾ä»¥åŠæ‹¦æˆªæ–¹æ³•å®šä¹‰å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„éœ€è¦æ‹¦æˆªæ¥å£çš„åœ°æ–¹è°ƒç”¨piniaçš„æ–¹æ³•å³å¯å¯¹æ¥å£è¿›è¡Œæ‹¦æˆªï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å°è£…ä¸€ä¸‹æˆ‘ä»¬çš„axiosè¯·æ±‚ä½¿ç”¨æ–¹æ³•ï¼Œæ¥å®Œæˆè‡ªå®šä¹‰çš„å°†æˆ‘ä»¬éœ€è¦æ‹¦æˆªçš„æ¥å£æ¨å…¥piniaçš„æ‹¦æˆªé˜Ÿåˆ—ä¸­å»ğŸ‘‹
## å°è£…axios
æˆ‘è®¾æƒ³çš„æ˜¯åœ¨æˆ‘ä»¬è¯·æ±‚çš„æ—¶å€™å¯ä»¥åŠ å…¥ä¸€ä¸ªé…ç½®å‚æ•°ç”¨æ¥è¯†åˆ«æ­¤æ¥å£æ˜¯éœ€è¦è¢«æ¨å…¥æ‹¦æˆªé˜Ÿåˆ—çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å¯¹axiosæš´éœ²æ–¹æ³•è¿›è¡ŒäºŒæ¬¡å°è£…
src/service/request.ts
```javascript
import axios from 'axios'
import { useAxiosStore } from '@/store/axios'
import BaseList from '@/service/baseServe'
import type { ApiObjTs, ApiReturnTs } from '@/service/types'
import Config from '@/config'

/* å®ä¾‹åŒ–è¯·æ±‚é…ç½® */
const instance: AxiosInstance = axios.create({
    baseURL: Config.domain, // '/api'
    // è¯·æ±‚æ—¶é•¿
    timeout: 60 * 1000,
    validateStatus() {
        // ä½¿ç”¨async-awaitï¼Œå¤„ç†rejectæƒ…å†µè¾ƒä¸ºç¹çï¼Œæ‰€ä»¥å…¨éƒ¨è¿”å›resolveï¼Œåœ¨ä¸šåŠ¡ä»£ç ä¸­å¤„ç†å¼‚å¸¸
        return true
    },
    transformResponse: [
        (data) => {
            if (
                typeof data === 'string'
                && (data.startsWith('{') || data.startsWith('['))
            )
                data = JSON.parse(data)

            return data
        }
    ]
})

const request = instance.request
const CancelToken = axios.CancelToken
const requestControl = <T, R = false>(option: ApiObjTs) => {
	// æ›¿æ¢æ‹¼æ¥urlçš„æœåŠ¡åœ°å€
    if (option.server) option.url = BaseList[option.server] + option.url
    // isIntercept æ¥å£æ‹¦æˆªæ ‡è¯†ä»£è¡¨æ­¤æ¥å£éœ€è¦è¢«æ‹¦æˆª
    if (option.isIntercept) {
        option.cancelToken = new CancelToken((cancel) => {
            const axiosStore = useAxiosStore()
            axiosStore.addIntercept(cancel)
        })
    }
    return request<any, ApiReturnTs<T, R>>(option)
}
```
è¿™è¾¹å°±ä¸æ”¾å…¥axiosçš„å“åº”æ‹¦æˆªå’Œè¯·æ±‚æ‹¦æˆªäº†ï¼Œä¸æœ¬æ–‡çš„æ ¸å¿ƒé€»è¾‘æ— å…³ â›½ï¸

src/service/type.ts
```javascript
import type { AxiosRequestConfig } from 'axios'
import type BaseList from '@/service/baseServe'
// å…¥å‚ç±»å‹
export interface ApiObjTs extends AxiosRequestConfig {
    url?: string // è¯·æ±‚åœ°å€
    server?: keyof Omit<typeof BaseList, 'prototype'> // è¯·æ±‚æœåŠ¡
    isIntercept?: boolean // æ˜¯å¦æ¨å…¥å…¨å±€çš„è¯·æ±‚æ‹¦æˆªæ ˆ
    baseURL?: string // æœ¬åœ°è°ƒè¯•æ—¶ æ¥å£ç‰¹æ®Šä»£ç†
}
// è¿”å›å€¼ç±»å‹
export type ApiReturnTs<T, X> = X extends true ? T : {
    code: number
    data: null | T
    message: string
}
```
apiæ–‡ä»¶é…ç½®ï¼š
src/api/public/index.ts
```javascript
import type { ApiObjTs } from '@/service/types'
import Request from '@/service/request'
// ç¤ºä¾‹æ¥å£
export const getSystemMenus = (data: PUBLIC_API_REQUEST.getSystemMenus, option:ApiObjTs={}) => {
    return Request<PUBLIC_API_RESPONSE.getSystemMenus>({
        url: '/api/v1.0/permissions/systemMenus',
        server: 'bspPermissionServer',
        method: 'post',
        headers: {
            'Content-Type': 'application/json'
        },
        data,
        ...option
    })
}
```
src/api/public/types.d.ts
```javascript
// è¯·æ±‚ä¼ å‚æ ¡éªŒ å‘½åç©ºé—´
declare namespace PUBLIC_API_REQUEST {
	type getSystemMenus = { 
		systemCode: 'wgmsAnalysisDiagnose' 
	}
}
// è¯·æ±‚å“åº”å‚æ•°
declare namespace PUBLIC_API_RESPONSE {
    type getSystemMenus = {
        entries: string[]
    }
}
```
åœ¨æ­¤æˆ‘ä»¬axiosä»¥åŠæ¥å£çš„å°è£…å°±å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥ç»ˆäºåˆ°æˆ‘ä»¬çš„ä½¿ç”¨é˜¶æ®µäº†ï¼ğŸ’©
æˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬è¯·æ±‚çš„æ—¶å€™ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥å¯¹è±¡å±æ€§```isIntercept```ä¸ºtrueå³å¯è¢«æ¨å…¥æˆ‘ä»¬çš„æ‹¦æˆªé˜Ÿåˆ—äº†
```javascript
import { getSystemMenus } from '@/api/public' // å•ä¸ªè¯·æ±‚å¯¼å…¥
const res = await getSystemMenus({ systemCode }, { isIntercept: true }) 
```
æˆ‘ä»¬åœ¨ä»»ä½•æƒ³ç”¨çš„æ—¶å€™åªéœ€è¦å¼•å…¥```pinia```çš„```axiosStore```è°ƒç”¨ç›¸åº”çš„æ–¹æ³•å°±å¯ä»¥äº†ğŸ‘´
```javascript
import { useAxiosStore } from '@/store/axios';
const axiosStore = useAxiosStore()
axiosStore.clearIntercept(1) // æ‹¦æˆªæœ€æ–°ä¸€æ¡è¯·æ±‚ï¼Œå¹¶åˆ é™¤
axiosStore.clearIntercept() // æ‹¦æˆªå…¨éƒ¨å¹¶æ¸…ç©ºæ‹¦æˆªé˜Ÿåˆ—
```
ä»¥ä¸Šå°±åŸºæœ¬å®Œæˆäº†æ¥å£æ‹¦æˆªåŠŸèƒ½çš„å°è£…ï¼Œéå¸¸å¼ºçš„çµæ´»æ€§ï¼Œå¯ä»¥åœ¨ä»»æ„æ—¶åˆ»æ‹¦æˆªä»»æ„éœ€è¦æ‹¦æˆªçš„æ¥å£ï¼Œä½†æ˜¯å¼Šç«¯æ˜¯æ‹¦æˆªåŠŸèƒ½ä¸æ˜¯æ‰˜ç®¡çš„ï¼Œéœ€è¦å¼€å‘äººå‘˜äº†è§£ä½¿ç”¨æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªè¡Œä¿®æ”¹ä½¿ç”¨ã€‚

# ä½œè€…

<ContributorView name="é©¬ä½³è¾‰"></ContributorView>
